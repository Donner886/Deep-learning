# Docker网络配置说明

## 问题描述
在构建Docker镜像时可能遇到网络连接问题，这是因为Docker默认使用Docker Hub，在国内访问可能较慢或不稳定。

## 解决方案

### 方法1: 配置Docker镜像加速器（推荐）

1. 创建或编辑Docker daemon配置文件：
   ```bash
   sudo mkdir -p /etc/docker
   sudo tee /etc/docker/daemon.json <<-'EOF'
   {
     "registry-mirrors": [
       "https://dz8ctiah.mirror.aliyuncs.com",
       "https://docker.mirrors.ustc.edu.cn",
       "https://hub-mirror.c.163.com", 
        "https://registry.docker-cn.com",
    "https://mirror.ccs.tencentyun.com",
    "https://dz8ctiah.mirror.aliyuncs.com"
     ]
   }
   EOF
   ```

2. 重启Docker服务：
   ```bash
   sudo systemctl daemon-reload
   sudo systemctl restart docker
   ```

3. 验证配置：
   ```bash
   docker info | grep -A 10 "Registry Mirrors"
   ```

### 方法2: 使用代理

如果公司网络需要代理，可以配置Docker使用代理：

1. 创建Docker服务配置目录：
   ```bash
   sudo mkdir -p /etc/systemd/system/docker.service.d
   ```

2. 创建代理配置文件：
   ```bash
   sudo tee /etc/systemd/system/docker.service.d/http-proxy.conf <<-'EOF'
   [Service]
   Environment="HTTP_PROXY=http://proxy.company.com:port"
   Environment="HTTPS_PROXY=http://proxy.company.com:port"
   Environment="NO_PROXY=localhost,127.0.0.1"
   EOF
   ```

3. 重启Docker服务：
   ```bash
   sudo systemctl daemon-reload
   sudo systemctl restart docker
   ```

### 方法3: 使用预构建镜像

如果网络问题持续存在，可以使用已经构建好的镜像：

```bash
# 拉取预构建镜像
docker pull crpi-8nfy446089zsqqbx.cn-guangzhou.personal.cr.aliyuncs.com/llm_agents/dnn_dev_env:latest

# 运行容器
docker run -d -p 80:8080 -v $(pwd)/notebooks:/app/notebooks crpi-8nfy446089zsqqbx.cn-guangzhou.personal.cr.aliyuncs.com/llm_agents/dnn_dev_env:latest
```

## 验证网络配置

配置完成后，可以测试网络连接：

```bash
# 测试Docker Hub连接
docker pull hello-world

# 如果成功，删除测试镜像
docker rmi hello-world
```


## 备用镜像源

如果阿里云镜像加速器不可用，可以尝试以下备用源：

- 中科大镜像: https://docker.mirrors.ustc.edu.cn
- 网易镜像: https://hub-mirror.c.163.com
- 腾讯云镜像: https://mirror.ccs.tencentyun.com
